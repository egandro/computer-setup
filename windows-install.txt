rem https://tinyurl.com/wininsta

Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

choco install -y googlechrome --ignore-checksums

choco install -y firefox

choco install -y vscode

choco install -y 7zip

choco install -y git

choco install -y svn

choco install -y wget

choco install -y youtube-dl

choco install -y winscp

choco install -y putty

choco install -y winrar

choco install -y nodejs

rem choco install -y vmwareworkstation

choco install -y virtualbox --params "/NoDesktopShortcut /ExtensionPack" --ignore-checksums

choco install -y vagrant

choco install -y kubernetes-cli

choco install -y kubernetes-helm

choco install -y openlens --ignore-checksums

choco install -y vlc

choco install -y foxitreader

choco install -y inkscape

choco install -y gimp

choco install -y nordvpn

choco install -y vnc-connect

rem choco install -y microsoft-teams.install

rem java
choco install -y openjdk

rem choco install androidstudio
rem choco install android-sdk
rem choco install arduino rem 1.9

rem C++ package manager
rem choco install -y conan

rem ICMP
rem https://www.howtogeek.com/howto/windows-vista/allow-pings-icmp-echo-request-through-your-windows-vista-firewall/

netsh advfirewall firewall add rule name="ICMP Allow incoming V4 echo request" protocol=icmpv4:8,any dir=in action=allow
netsh advfirewall firewall add rule name="ICMP Allow incoming V6 echo request" protocol=icmpv6:8,any dir=in action=allow

rem ssh
rem https://stackoverflow.com/questions/16212816/setting-up-openssh-for-windows-using-public-key-authentication
---
Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
Start-Service sshd

(Get-Content "$Env:PROGRAMDATA\ssh\sshd_config") -Replace 'Match Group', '#Match Group' | Set-Content "$Env:PROGRAMDATA\ssh\sshd_config"
(Get-Content "$Env:PROGRAMDATA\ssh\sshd_config") -Replace 'AuthorizedKeysFile', '#AuthorizedKeysFile' | Set-Content "$Env:PROGRAMDATA\ssh\sshd_config"

Add-Content "$Env:PROGRAMDATA\ssh\sshd_config" "AuthorizedKeysFile  .ssh/authorized_keys"
Add-Content "$Env:PROGRAMDATA\ssh\sshd_config" "PasswordAuthentication no"
Add-Content "$Env:PROGRAMDATA\ssh\sshd_config" "PubkeyAuthentication yes"

Set-Service -Name ssh-agent -StartupType Automatic
Set-Service -Name sshd -StartupType Automatic
Start-Service sshd
Start-Service ssh-agent

rem --
rem open port 8022 on firewall
netsh advfirewall firewall add rule name= "Open Port 8022" dir=in action=allow protocol=TCP localport=8022

